January 3, 2026

I tried to run `lein figwheel` on my new Mac.  Unable to, apparently because of different incompatible architecture.  Switched to my Ubuntu Linux box; `lein figwheel` worked right away.  Will want to get the Mac to workbut will address that later.

Getting back to the swing of things: Running ppex002 and ppex003, each with 300 WCs and 300 CCs.  I'm also resurrecting ppex004 in CLJS (not to be confused by the experiment in CLJ whose results were shared in Montreal). Results of all of the above are below:

|Experiment|#WCs|#CCs|#Iterations Year One|#Iterations Year Two|Has Pollutants?|
|-|-|-|-|-|
|ppex002|300|300|64|1|Yes|
|ppex003|300|300|57|12|Yes|
|ppex004|3000|3000|96|11|Yes|
|ppex002|300|300|42|1|No|
|ppex003|300|300|55|5|No|
|ppex004|3000|3000|41|6|No|

FYI: ppex004 with pollutants caused the Ubuntu box to freeze.  The results are based off a CSV generating from the same output.

As it stands:

* Cannot run 6000 councils in Ubuntu
* Cannot run figwheel on Mac

---

January 4, 2026

Update: Worked to get figwheel running again on a Mac.  The issue was that I needed to get the latest version of JNA (Java Native Access) to match the ccompatibility of my new Apple Silicon Mac.  Once I got that, the app worked on my new Mac.

Getting back to the swing of things: Running ppex002 and ppex003, each with 300 WCs and 300 CCs.  I'm also resurrecting ppex004 in CLJS (not to be confused by the experiment in CLJ whose results were shared in Montreal). Results of all of the above are below:

Also got 6000 councils loaded into pequod-plus CLJS, with experiment 004.  The results are as follows:

|Experiment|#WCs|#CCs|#Iterations Year One|#Iterations Year Two|Has Pollutants?|
|-|-|-|-|-|
|ppex004|3000|3000|69|11|Yes|
|ppex004|3000|3000|41|6|No|

I'm going to figure out how to speed up experiments when scaled up to 30,000 WCs and 30,000 CCs.  Idea: Use multithreading?

The approach to use: a massive code-optimization and cleanup effort.  I realized that there's a LOT of room for improvement.  That improvement is underway, and likely will take a number of weeks to complete. 

January 10, 2026

Spent the day optimizing.  Commits are noted in the github repository, main branch.  Got solution-4 and solution-5 as optimized as reasonably feasible.  Had a setback, but was able to overcome it.

January 18, 2026

Optimizations are now complete to the extent determined and readily achievable.  Code seems to work well for extant experiments.  I created a new experiment to test scaling up -- 6000 WCs, 6000 CCs, double the current largest total.  Speed of CLJS seems okay considering the scale, but the numbers are wildly crazy: seeing logs of NAN and even Infinity values in the output.  Not sure what's going on there.  Will have to dig to find out.  I'm debating with myself whether or not to go down this route, and how.

January 19, 2026

Got the problem fixed: The coefficients for WCs were based on a scale of 100 rather than 10.  Updating that fixed matters.  In fact, I was able to create an experiment of 12K councils that was able to converge in 14 year-two iterations.  Updating the code and the experiment to compensate.

January 20, 2026

We're now up to 18,000 councils in the cljs code, with each iteration taking roughly two seconds of processing time in the browser.  I think we can deem the optimizations a success and can move on to the next phase.  Quoting from Robin:

"The first thing you are going to work on is figuring out why the number of iterations increased substantially when we introduced one pollutant. I have an hypothesis we can easily test:

"I think the coefficients I gave you for the inputs in the production functions for WCs were way too big. I had no idea what size to choose. It could be that I chose coefficients so large that it made producing things unrealistically expensive because we were signaling that producing everything made the damage to the environment way too large. If I'm right, it may be taking a lot of iterations to find a solution because the optimal solution is very unrealistic.

"One way to check is to see if the output of goods and services we arrived a with the pollutants as optimal is ridiculously less than the outputs we would arrive at if we simply run the simulations with no pollutants at all.

"If I'm right we can fix things very easily. We just need to cut those coefficients for the pollutants in our production functions by say, a factor of ten. If I'm right we should achieve convergence in noticeably fewer iterations even when we have "reasonably realistic" pollutants in the system."

I'm not sure what is meant exactly by "coefficients".  Let me call Robin and find out.

January 21, 2026

With no further code changes (and admittedly with a newer and faster computer), I'm running the csvgen code, using the optimizations I've made in the past week:

$ time lein run -m pequod-plus.csvgen ppex004 > ppex004-with-pollutants-after-optimization.csv

So far (and this is still preliminary, we'll wait until the full experiment is complete) -- the results are dramatically faster.  An iteration with 60,000 councils now takes about two minutes, which would mean a completion time from start to finish of around two hours, as opposed to something like 12 hours.  I'll wait to see how long this experiment takes.

January 24, 2026

```
mitchell:2026-01-24 10:08:08:~/pequod/pequod-plus$ time lein run -m pequod-plus.csvgen ppex004 > ppex004-with-pollutants-after-optimization.csv

real	240m35.310s
user	510m4.903s
sys	8m4.632s
```

Got a full-sized experiment complete, with pollutants, in exactly four hours -- a testament to both the improvement in the code _and_ the faster computer I'm using (which at one point was using three cores to finish the job).

This is encouraging, and a considerable speed-up from the work for Montreal where it would take upwards of 12 hours to process a single experiment.

January 31, 2026

Good progress.  Met with Robin where we agreed on what to do next: Basically for the experiments we ran for Montreal, change each pollutant exponent (divide by 10) and rerun the experiment.  Robin and I sent an email to Josh about payment details.  I am now clear on what to do, and can now proceed.

Update: I have reviewed the experimental results from Montreal, and compared them with the results of my most recent update.  Also: I am writing a Python script to update the contents of a ppex file per Robin's instructions; luckily, I can do this with some reasonably simple string matching and manipulation, and am working on this presently. 

February 1, 2026

First take didn't take.  The Python script is too inefficient as written; something that should have completed in maybe a matter of minutes took hours to complete.  Will need to revise.  Doing that next.
